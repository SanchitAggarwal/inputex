YUI.add("inputex-group",function(e,t){YUI.add("inputex-group",function(e){var t=e.Lang,n=e.inputEx;n.Group=function(e){n.Group.superclass.constructor.call(this,e),this.options.value||this.runFieldsInteractions()},e.extend(n.Group,n.Field,{setOptions:function(e){n.Group.superclass.setOptions.call(this,e),this.options.className=e.className||"inputEx-Group",this.options.fields=e.fields,this.options.flatten=e.flatten,this.options.legend=e.legend||"",this.options.collapsible=t.isUndefined(e.collapsible)?!1:e.collapsible,this.options.collapsed=t.isUndefined(e.collapsed)?!1:e.collapsed,this.options.disabled=t.isUndefined(e.disabled)?!1:e.disabled,this.inputs=[],this.inputsNames={}},render:function(){this.divEl=n.cn("div",{className:this.options.className}),this.options.id&&(this.divEl.id=this.options.id),this.renderFields(this.divEl),this.options.disabled&&this.disable()},renderFields:function(e){this.fieldset=n.cn("fieldset"),this.legend=n.cn("legend",{className:"inputEx-Group-legend"});if(this.options.collapsible){var r=n.cn("div",{className:"inputEx-Group-collapseImg"},null," ");this.legend.appendChild(r),n.sn(this.fieldset,{className:"inputEx-Expanded"})}!t.isUndefined(this.options.legend)&&this.options.legend!==""&&this.legend.appendChild(n.cn("span",null,null," "+this.options.legend)),(this.options.collapsible||!t.isUndefined(this.options.legend)&&this.options.legend!=="")&&this.fieldset.appendChild(this.legend);for(var i=0;i<this.options.fields.length;i++){var s=this.options.fields[i];if(!s)throw new Error("inputEx.Form: One of the provided fields is undefined ! (check trailing comma)");this.addField(s)}this.options.collapsed&&this.toggleCollapse(),e.appendChild(this.fieldset)},addField:function(e){var t=this.renderField(e);this.fieldset.appendChild(t.getEl())},renderField:function(r){var i=n(r,this);return this.inputs.push(i),i.options.name&&(this.inputsNames[i.options.name]=i),i.options.flatten&&t.isObject(i.inputsNames)&&(e.mix(this.inputsNames,i.inputsNames),this.inputs=this.inputs.concat(i.inputs)),!this.hasInteractions&&r.interactions&&(this.hasInteractions=!0),i.on("updated",this.onChange,this),i},initEvents:function(){this.options.collapsible&&e.on("click",this.toggleCollapse,this.legend,this)},toggleCollapse:function(){e.one(this.fieldset).hasClass("inputEx-Expanded")?e.one(this.fieldset).replaceClass("inputEx-Expanded","inputEx-Collapsed"):e.one(this.fieldset).replaceClass("inputEx-Collapsed","inputEx-Expanded")},validate:function(){var e=!0;for(var t=0;t<this.inputs.length;t++){var r=this.inputs[t];if(!r.isDisabled()){var i=r.getState();r.setClassFromState(i);if(i==n.stateRequired||i==n.stateInvalid)e=!1}}return e},getFieldsStates:function(){var e,t,r,i,s={fields:{},validate:!0};for(var o=0;o<this.inputs.length;o++){e=this.inputs[o],t=e.options.name,r=e.getState(),i=e.getStateString(r),s.fields[t]={},s.fields[t].valid=!0,s.fields[t].message=i;if(r==n.stateRequired||r==n.stateInvalid)s.fields[t].valid=!1,s.validate=!1}return s},enable:function(){for(var e=0;e<this.inputs.length;e++)this.inputs[e].enable()},disable:function(){for(var e=0;e<this.inputs.length;e++)this.inputs[e].disable()},setValue:function(e,n){if(!e)return;for(var r=0;r<this.inputs.length;r++){var i=this.inputs[r],s=i.options.name;s&&!t.isUndefined(e[s])?i.setValue(e[s],!1):i.clear(!1)}this.runFieldsInteractions(),n!==!1&&this.fireUpdatedEvt()},getValue:function(){var n={};for(var r=0;r<this.inputs.length;r++){var i=this.inputs[r].getValue();this.inputs[r].options.name&&(this.inputs[r].options.flatten&&t.isObject(i)?e.mix(n,i):n[this.inputs[r].options.name]=i)}return n},close:function(){for(var e=0;e<this.inputs.length;e++)this.inputs[e].close()},focus:function(){this.inputs.length>0&&this.inputs[0].focus()},getFieldByName:function(e){return this.inputsNames.hasOwnProperty(e)?this.inputsNames[e]:null},findFieldByName:function(e,n){var r=this,i,s;if(n){if(this.inputsNames.hasOwnProperty(e)&&(s=this.inputsNames[e]))for(var o,u=this.inputs,a=0,f=u.length;a<f;++a){o=u[a];if(t.isFunction(o.getFieldByName)&&(s=o.getFieldByName(e,!0)))break}return s}while((i=r.getParentField())&&t.isFunction(i.getFieldByName))r=i;return r.getFieldByName(e,!0)},onChange:function(e,t){this.runInteractions(t,e),this.fireUpdatedEvt()},runAction:function(e,n){var r=this.getFieldByName(e.name);if(t.isFunction(r[e.action]))r[e.action].call(r);else{if(!t.isFunction(e.action))throw new Error("action "+e.action+" is not a valid action for field "+e.name);e.action.call(r,n)}},runInteractions:function(e,r){var i=n.indexOf(e,this.inputs),s=this.options.fields[i];if(t.isUndefined(s.interactions))return;var o=s.interactions;for(var u=0;u<o.length;u++){var a=o[u];if(a.valueTrigger===r)for(var f=0;f<a.actions.length;f++)this.runAction(a.actions[f],r)}},runFieldsInteractions:function(){if(this.hasInteractions)for(var e=0;e<this.inputs.length;e++)this.runInteractions(this.inputs[e],this.inputs[e].getValue())},clear:function(e){for(var t=0;t<this.inputs.length;t++)this.inputs[t].clear(!1);e!==!1&&this.fireUpdatedEvt()},setErrors:function(n){var r,i;if(t.isArray(n))for(r=0;r<n.length;r++)i=n[r][0],value=n[r][1],this.inputsNames[i]&&this.inputsNames[i].options.showMsg&&(this.inputsNames[i].displayMessage(value),e.one(this.inputsNames[i].divEl).replaceClass("inputEx-valid","inputEx-invalid"));else if(t.isObject(n))for(i in n)n.hasOwnProperty(i)&&this.inputsNames[i]&&this.inputsNames[i].options.showMsg&&(this.inputsNames[i].displayMessage(n[i]),e.one(this.inputsNames[i].divEl).replaceClass("inputEx-valid","inputEx-invalid"))},setFieldName:function(e){var t=this.inputs.length;for(var n=0;n<t;n++)this.inputs[n].setFieldName(e+""+(this.inputs[n].el&&this.inputs[n].el.name||"group-"+n))},destroy:function(){var e,t,r;for(e=0,t=this.inputs.length;e<t;e++)r=this.inputs[e],r.destroy();n.Group.superclass.destroy.call(this)}}),n.registerType("group",n.Group,[{type:"string",label:"Name",name:"name",value:""},{type:"string",label:"Legend",name:"legend"},{type:"boolean",label:"Collapsible",name:"collapsible",value:!1},{type:"boolean",label:"Collapsed",name:"collapsed",value:!1},{type:"list",label:"Fields",name:"fields",elementType:{type:"type"}}],!0)},"3.1.0",{requires:["inputex-field"]})},"@VERSION@");
